flowchart TB
  %% Updated architecture with ML prediction capabilities (predictor-only)

  subgraph Input [Data Input]
    CSV[CSV Loader<br/>OHLCV Data]
    Bars[Historical Bars<br/>Date,Open,High,Low,Close,Volume]
  end

  CSV --> Bars

  subgraph Processing [Data Processing]
    Indicators[Technical Indicators<br/>SMA, EMA, RSI, MACD]
    Features[Feature Engineering<br/>16 predictive features]
  end

  Bars --> Indicators
  Bars --> Features

  subgraph ML [Machine Learning]
    FeatureMatrix[Feature Matrix<br/>Returns, Lags, Indicators]
    TrainTest[Train/Test Split<br/>80% / 20%]
    LinReg[Linear Regression<br/>y = β₀ + Σ βᵢxᵢ]
    ModelEval[Model Evaluation<br/>MSE, RMSE, R²]
  end

  Features --> FeatureMatrix
  FeatureMatrix --> TrainTest
  TrainTest --> LinReg
  LinReg --> ModelEval

  %% Predictor outputs only
  subgraph Output [Outputs]
    PredOut[Price Predictions<br/>Future Forecasts]
    Accuracy[Accuracy Metrics<br/>Model Performance]
    Console[Console Output]
  end

  ModelEval --> PredOut
  ModelEval --> Accuracy
  PredOut --> Console
  Accuracy --> Console

  subgraph Executables [Build Outputs]
    PredExe[predictor.exe<br/>ML Price Predictor]
    PredTests[predictor_tests.exe<br/>ML Unit Tests]
  end

  LinReg -. builds .-> PredExe
  LinReg -. tests .-> PredTests

  classDef new fill:#10b981,stroke:#059669,color:#fff,stroke-width:2px;
  classDef output fill:#f59e0b,stroke:#d97706,color:#fff,stroke-width:2px;

  class ML,Features,FeatureMatrix,LinReg,ModelEval,PredOut,Accuracy,PredExe,PredTests new;
  class Output,Console output;
